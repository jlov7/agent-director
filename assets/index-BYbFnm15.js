import{r as c,j as e,k as ue,l as me,m as G,n as he,u as ge,o as xe,p as D,q as je,t as ve,v as be,w as A,x as Ne,y as I,z as K,A as Q,B as ye,C as ke,D as fe,E as Ce,F as _e}from"./index-Dwmev8U6.js";function Fe(a,v,b){return Math.min(b,Math.max(v,a))}function Me({state:a,playheadMs:v,onUpdate:b,session:r,playerId:p,sessionError:L,onCreateSession:k,onJoinSession:u,onLeaveSession:f,onDispatchAction:N,guild:m,onCreateGuild:C,onJoinGuild:_,onScheduleGuildEvent:F,onCompleteGuildEvent:S,observability:n,analytics:t}){const[g,T]=c.useState(""),[M,X]=c.useState("strategist"),[R,Y]=c.useState("alt path"),[q,J]=c.useState("Night Ops"),[B,ee]=c.useState(""),[E,se]=c.useState("operator"),[y,ae]=c.useState("guild-night-ops"),[z,le]=c.useState("Night Ops Guild"),[H,ne]=c.useState("Weekly Raid Drill"),[W,ie]=c.useState("2026-02-16T20:00:00Z"),[d,te]=c.useState(""),[P,ce]=c.useState("Abusive behavior"),[U,re]=c.useState("1"),[Z,oe]=c.useState("1"),[w,de]=c.useState("Weekly balance update"),$=!!(r!=null&&r.id&&N),l=(s,i,o)=>{if($){N==null||N(s,i);return}b(o)},h=c.useMemo(()=>a.narrative.nodes.find(s=>s.id===a.narrative.currentNodeId),[a.narrative.currentNodeId,a.narrative.nodes]),O=c.useMemo(()=>{var o;const s=[a.raid.completed,a.campaign.depth>=3,a.narrative.history.length>=2,a.skills.loadout.equipped.length>=2,a.pvp.round>=3||a.pvp.winner!=null,a.time.forks.length>=2||((o=a.time.forks[0])==null?void 0:o.history.length)>1,a.boss.hp<a.boss.maxHp,a.director.lastOutcome!=="mixed",a.economy.crafted.length>=1,a.guild.operationsScore>0,a.cinematic.queue.length>=1,a.liveops.week>=2],i=s.filter(Boolean).length;return{done:i,total:s.length,pct:Math.round(i/s.length*100)}},[a]),x=a.safety??{mutedPlayerIds:[],blockedPlayerIds:[],reports:[]},j=c.useMemo(()=>a.outcome.status==="win"||a.outcome.status==="loss"?4:a.raid.objectives.some(i=>i.progress>0)||a.pvp.round>0||a.time.forks.length>1?a.campaign.depth>1||a.narrative.history.length>0?3:2:1,[a]);return e.jsxs("section",{className:"gameplay-mode",children:[e.jsxs("header",{className:"gameplay-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Gameplay Command Center"}),e.jsx("p",{children:"World-class mechanics stack: raids, campaign, narrative, PvP, time control, boss runs, and liveops."}),e.jsx("p",{children:"v1 core loop target session length: 18-22 minutes."}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:q,onChange:s=>J(s.target.value),placeholder:"Session name","aria-label":"Session name"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>k==null?void 0:k(q),children:"Create multiplayer session"}),e.jsx("input",{className:"search-input",value:B,onChange:s=>ee(s.target.value),placeholder:"Session id","aria-label":"Join session id"}),e.jsxs("select",{value:E,onChange:s=>se(s.target.value),children:[e.jsx("option",{value:"strategist",children:"Strategist"}),e.jsx("option",{value:"operator",children:"Operator"}),e.jsx("option",{value:"analyst",children:"Analyst"}),e.jsx("option",{value:"saboteur",children:"Saboteur"})]}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>u==null?void 0:u(B,p??"director",E),children:"Join session"}),r!=null&&r.id?e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>f==null?void 0:f(),children:"Leave session"}):null]}),e.jsxs("p",{children:["Session: ",(r==null?void 0:r.id)??"local-only"," ",p?`• Player ${p}`:""," ",r?`• Version ${r.version}`:""]}),L?e.jsx("p",{children:L}):null]}),e.jsxs("div",{className:"gameplay-completion","aria-label":"Gameplay completion",children:[e.jsxs("strong",{children:[O.done,"/",O.total]}),e.jsxs("span",{children:[O.pct,"% complete"]})]})]}),e.jsxs("div",{className:"gameplay-grid",children:[e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"0) Core Loop + Outcomes"}),e.jsxs("p",{children:["Phase ",j,"/4 • Outcome ",a.outcome.status.replace("_"," ")]}),e.jsx("p",{children:a.outcome.reason}),e.jsxs("div",{className:"gameplay-list",children:[e.jsx("div",{className:"gameplay-node",children:e.jsxs("span",{children:[j>=1?"x":"o"," Brief: inspect run and set objective"]})}),e.jsx("div",{className:"gameplay-node",children:e.jsxs("span",{children:[j>=2?"x":"o"," Execute: complete raid and mission actions"]})}),e.jsx("div",{className:"gameplay-node",children:e.jsxs("span",{children:[j>=3?"x":"o"," Adapt: choose narrative and tune loadout/liveops"]})}),e.jsx("div",{className:"gameplay-node",children:e.jsxs("span",{children:[j>=4?"x":"o"," Resolve: finish with win/loss review"]})})]}),e.jsxs("div",{className:"gameplay-list",children:[e.jsx("p",{children:"Telemetry funnels:"}),e.jsx("div",{className:"gameplay-node",children:e.jsx("span",{children:"funnel.session_start"})}),e.jsx("div",{className:"gameplay-node",children:e.jsx("span",{children:"funnel.first_objective_progress"})}),e.jsx("div",{className:"gameplay-node",children:e.jsx("span",{children:"funnel.first_mission_outcome"})}),e.jsx("div",{className:"gameplay-node",children:e.jsx("span",{children:"funnel.run_outcome"})})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"1) Co-op Incident Raids"}),e.jsxs("p",{children:["Party: ",a.raid.party.length," members"]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:g,onChange:s=>T(s.target.value),placeholder:"Member name","aria-label":"Raid member name"}),e.jsxs("select",{value:M,onChange:s=>X(s.target.value),children:[e.jsx("option",{value:"strategist",children:"Strategist"}),e.jsx("option",{value:"operator",children:"Operator"}),e.jsx("option",{value:"analyst",children:"Analyst"}),e.jsx("option",{value:"saboteur",children:"Saboteur"})]}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>{g.trim()&&($?u==null||u((r==null?void 0:r.id)??"",g.trim(),M):b(s=>ue(s,g.trim(),M)),T(""))},children:"Add member"})]}),e.jsx("div",{className:"gameplay-objectives",children:a.raid.objectives.map(s=>e.jsxs("div",{className:"gameplay-objective",children:[e.jsx("span",{children:s.label}),e.jsxs("span",{children:[s.progress,"/",s.target]}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("raid.objective_progress",{objective_id:s.id,delta:25},i=>me(i,s.id,25)),children:"+25"})]},s.id))})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"2) Roguelike Scenario Campaign"}),e.jsxs("p",{children:["Depth ",a.campaign.depth," • Lives ",a.campaign.lives]}),e.jsxs("p",{children:[a.campaign.currentMission.title," (difficulty ",a.campaign.currentMission.difficulty,")"]}),e.jsx("p",{children:"Difficulty ramp bands: D1-1, D2-3, D4-5, D6-7, D8-9, D10+."}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"primary-button",type:"button",onClick:()=>l("campaign.resolve_mission",{success:!0},s=>G(s,!0)),children:"Mission success"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("campaign.resolve_mission",{success:!1},s=>G(s,!1)),children:"Mission fail"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"3) Branching Narrative Director"}),e.jsx("p",{children:h==null?void 0:h.title}),e.jsxs("p",{children:["Tension ",a.narrative.tension]}),e.jsx("div",{className:"gameplay-list",children:((h==null?void 0:h.choices)??[]).map(s=>e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("narrative.choose",{choice_id:s.id},i=>he(i,s.id)),children:s.label},s.id))})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"4) Skill Tree + Loadout"}),e.jsxs("p",{children:["Points ",a.skills.points," • Equipped ",a.skills.loadout.equipped.length,"/",a.skills.loadout.capacity]}),e.jsx("div",{className:"gameplay-list",children:a.skills.nodes.map(s=>e.jsxs("div",{className:"gameplay-node",children:[e.jsxs("span",{children:[s.label," (",s.cost,")"]}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("skills.unlock",{player_id:p??"director",skill_id:s.id},i=>ge(i,s.id)),children:s.unlocked?"Unlocked":"Unlock"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("skills.equip",{player_id:p??"director",skill_id:s.id},i=>xe(i,s.id)),children:"Equip"})]},s.id))})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"5) Asymmetric PvP"}),e.jsxs("p",{children:["Round ",a.pvp.round," • Stability ",a.pvp.stability," • Sabotage ",a.pvp.sabotage]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("pvp.act",{action:"sabotage"},s=>D(s,"sabotage")),children:"Sabotage"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("pvp.act",{action:"stabilize"},s=>D(s,"stabilize")),children:"Stabilize"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("pvp.act",{action:"scan"},s=>D(s,"scan")),children:"Scan"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"6) Time Manipulation"}),e.jsxs("p",{children:["Active fork: ",a.time.activeForkId]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:R,onChange:s=>Y(s.target.value),"aria-label":"Fork label"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("time.create_fork",{label:R,playhead_ms:v},s=>je(s,R,v)),children:"Create fork"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("time.rewind",{amount_ms:1e3},s=>ve(s,1e3)),children:"Rewind 1s"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("time.merge",{fork_id:a.time.activeForkId},s=>be(s,s.time.activeForkId)),children:"Merge"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"7) Boss Encounter Runs"}),e.jsxs("p",{children:[a.boss.name," • Phase ",a.boss.phase," • HP ",a.boss.hp,"/",a.boss.maxHp]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("boss.act",{action:"strike"},s=>A(s,"strike")),children:"Strike"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("boss.act",{action:"shield"},s=>A(s,"shield")),children:"Shield"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("boss.act",{action:"exploit"},s=>A(s,"exploit")),children:"Exploit"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"8) Adaptive AI Dungeon Master"}),e.jsxs("p",{children:["Risk ",a.director.risk," • Outcome ",a.director.lastOutcome]}),e.jsx("p",{children:a.director.hint}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>{var V;const s=a.pvp.sabotage>a.pvp.stability?2:0,i=Math.floor((((V=a.raid.objectives[0])==null?void 0:V.progress)??0)/40),o=900+a.pvp.fog*10;l("director.evaluate",{failures:s,retries:i,latency_ms:o},pe=>Ne(pe,{failures:s,retries:i,latencyMs:o}))},children:"Recompute guidance"})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"9) Mission Economy + Crafting"}),e.jsxs("p",{children:["Credits ",a.economy.credits," • Materials ",a.economy.materials]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("economy.craft",{recipe_id:"stability_patch"},s=>I(s,"stability_patch")),children:"Craft stability patch"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("economy.craft",{recipe_id:"precision_lens"},s=>I(s,"precision_lens")),children:"Craft precision lens"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("economy.craft",{recipe_id:"overclock_core"},s=>I(s,"overclock_core")),children:"Craft overclock core"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"10) Guild Operations"}),e.jsxs("p",{children:[a.guild.name," • Ops score ",a.guild.operationsScore," • Events ",a.guild.eventsCompleted]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:y,onChange:s=>ae(s.target.value),placeholder:"Guild id","aria-label":"Guild id"}),e.jsx("input",{className:"search-input",value:z,onChange:s=>le(s.target.value),placeholder:"Guild name","aria-label":"Guild name"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>C==null?void 0:C(y,z),children:"Create guild"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>_==null?void 0:_(y,g.trim()||p||"director"),children:"Join guild"})]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:H,onChange:s=>ne(s.target.value),placeholder:"Event title","aria-label":"Guild event title"}),e.jsx("input",{className:"search-input",value:W,onChange:s=>ie(s.target.value),placeholder:"2026-02-16T20:00:00Z","aria-label":"Guild event schedule"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>F==null?void 0:F(y,H,W),children:"Schedule event"})]}),m?e.jsxs("div",{className:"gameplay-list",children:[e.jsxs("p",{children:[m.member_count," members • Score ",m.operations_score]}),m.scoreboard.slice(0,4).map(s=>e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:s.player_id}),e.jsx("span",{children:s.score})]},s.player_id)),m.events.slice(-3).map(s=>e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:s.title}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>S==null?void 0:S(m.id,s.id,10),children:"Complete"})]},s.id))]}):null,e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("guild.op",{impact:6},s=>K(s,6)),children:"Positive op"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("guild.op",{impact:-3},s=>K(s,-3)),children:"Risky op"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"11) Cinematic Event Engine"}),e.jsxs("p",{children:[a.cinematic.queue.length," queued events"]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("cinematic.emit",{event_type:"critical",message:"Critical cascade detected",intensity:3},s=>Q(s,"critical","Critical cascade detected",3)),children:"Critical beat"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("cinematic.emit",{event_type:"success",message:"System stabilizing",intensity:2},s=>Q(s,"success","System stabilizing",2)),children:"Success beat"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"12) Seasonal LiveOps"}),e.jsxs("p",{children:[a.liveops.season," • Week ",a.liveops.week]}),e.jsx("p",{children:a.liveops.challenge.title}),e.jsxs("p",{children:["Difficulty x",a.liveops.difficultyFactor.toFixed(2)," • Reward x",a.liveops.rewardMultiplier.toFixed(2)]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("liveops.advance_week",{},s=>ye(s)),children:"Next week"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("liveops.progress",{delta:1},s=>({...s,liveops:{...s.liveops,challenge:{...s.liveops.challenge,progress:Fe(s.liveops.challenge.progress+1,0,s.liveops.challenge.goal),completed:s.liveops.challenge.progress+1>=s.liveops.challenge.goal}}})),children:"Progress challenge"})]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:U,onChange:s=>re(s.target.value),placeholder:"Difficulty (0.6-1.6)","aria-label":"LiveOps difficulty factor"}),e.jsx("input",{className:"search-input",value:Z,onChange:s=>oe(s.target.value),placeholder:"Reward (0.5-2.0)","aria-label":"LiveOps reward multiplier"})]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:w,onChange:s=>de(s.target.value),placeholder:"Tuning note","aria-label":"LiveOps tuning note"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>{const s=Number.parseFloat(U),i=Number.parseFloat(Z);l("liveops.balance",{difficulty_factor:Number.isFinite(s)?s:1,reward_multiplier:Number.isFinite(i)?i:1,note:w},o=>ke(o,{difficultyFactor:Number.isFinite(s)?s:1,rewardMultiplier:Number.isFinite(i)?i:1,note:w}))},children:"Apply balancing"})]}),a.liveops.tuningHistory.length>0?e.jsx("div",{className:"gameplay-list",children:a.liveops.tuningHistory.slice(0,3).map(s=>e.jsxs("div",{className:"gameplay-node",children:[e.jsxs("span",{children:[new Date(s.changedAt).toLocaleDateString()," • ",s.note]}),e.jsxs("span",{children:["D x",s.difficultyFactor.toFixed(2)," / R x",s.rewardMultiplier.toFixed(2)]})]},s.id))}):null]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"13) Safety and Moderation"}),e.jsxs("p",{children:["Muted ",x.mutedPlayerIds.length," • Blocked ",x.blockedPlayerIds.length," • Reports"," ",x.reports.length]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:d,onChange:s=>te(s.target.value),placeholder:"Player id","aria-label":"Safety player id"}),e.jsx("input",{className:"search-input",value:P,onChange:s=>ce(s.target.value),placeholder:"Reason","aria-label":"Safety reason"})]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("safety.mute",{target_player_id:d},s=>fe(s,d)),children:"Mute player"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("safety.block",{target_player_id:d},s=>Ce(s,d)),children:"Block player"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("safety.report",{target_player_id:d,reason:P},s=>_e(s,d,P)),children:"Report player"})]}),x.reports.length>0?e.jsx("div",{className:"gameplay-list",children:x.reports.slice(0,3).map(s=>e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:s.targetPlayerId}),e.jsx("span",{children:s.reason})]},s.id))}):null]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"14) Observability + Funnel Analytics"}),e.jsxs("p",{children:["Sessions ",(n==null?void 0:n.metrics.total_sessions)??0," • Running ",(n==null?void 0:n.metrics.running_sessions)??0]}),e.jsxs("p",{children:["Avg latency ",Math.round((n==null?void 0:n.metrics.avg_latency_ms)??0),"ms • P95"," ",Math.round((n==null?void 0:n.metrics.p95_latency_ms)??0),"ms"]}),e.jsxs("p",{children:["Failure rate ",((n==null?void 0:n.metrics.failure_rate_pct)??0).toFixed(2),"% • Challenge completion"," ",((n==null?void 0:n.metrics.challenge_completion_rate_pct)??0).toFixed(2),"%"]}),e.jsxs("div",{className:"gameplay-list",children:[e.jsx("p",{children:"Funnels"}),e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:"Session start"}),e.jsx("span",{children:(t==null?void 0:t.funnels.session_start)??0})]}),e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:"First objective progress"}),e.jsx("span",{children:(t==null?void 0:t.funnels.first_objective_progress)??0})]}),e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:"First mission outcome"}),e.jsx("span",{children:(t==null?void 0:t.funnels.first_mission_outcome)??0})]}),e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:"Run outcome"}),e.jsx("span",{children:(t==null?void 0:t.funnels.run_outcome)??0})]})]}),e.jsx("div",{className:"gameplay-list",children:e.jsxs("p",{children:["Retention D1 ",((t==null?void 0:t.retention.d1_pct)??0).toFixed(2),"% • D7"," ",((t==null?void 0:t.retention.d7_pct)??0).toFixed(2),"% • D30 ",((t==null?void 0:t.retention.d30_pct)??0).toFixed(2),"%"]})}),n!=null&&n.alerts.length?e.jsx("div",{className:"gameplay-list",children:n.alerts.slice(0,3).map(s=>e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:s.severity.toUpperCase()}),e.jsx("span",{children:s.message})]},s.id))}):null]})]})]})}export{Me as default};
