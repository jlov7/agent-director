import{r as n,j as e,k as le,m as te,l as ie,n as ne,o as ce,p as H,q as re,u as oe,t as de,v as M,w as pe,x as ue,y as he,z as R,A as me,B as I,C as Z,D as $,E as ge}from"./index-CjdtY9-_.js";function be(s,g,c){return Math.min(c,Math.max(g,s))}function je({state:s,playheadMs:g,onUpdate:c,session:i,playerId:o,sessionError:O,onCreateSession:y,onJoinSession:d,onLeaveSession:v,onDispatchAction:b,guild:p,onCreateGuild:N,onJoinGuild:k,onScheduleGuildEvent:C,onCompleteGuildEvent:f}){const[h,A]=n.useState(""),[_,D]=n.useState("strategist"),[S,V]=n.useState("alt path"),[q,G]=n.useState("Night Ops"),[T,K]=n.useState(""),[B,Q]=n.useState("operator"),[x,U]=n.useState("guild-night-ops"),[E,X]=n.useState("Night Ops Guild"),[F,Y]=n.useState("Weekly Raid Drill"),[w,J]=n.useState("2026-02-16T20:00:00Z"),[j,ee]=n.useState(""),[z,ae]=n.useState("Abusive behavior"),L=!!(i!=null&&i.id&&b),l=(a,t,r)=>{if(L){b==null||b(a,t);return}c(r)},u=n.useMemo(()=>s.narrative.nodes.find(a=>a.id===s.narrative.currentNodeId),[s.narrative.currentNodeId,s.narrative.nodes]),P=n.useMemo(()=>{var r;const a=[s.raid.completed,s.campaign.depth>=3,s.narrative.history.length>=2,s.skills.loadout.equipped.length>=2,s.pvp.round>=3||s.pvp.winner!=null,s.time.forks.length>=2||((r=s.time.forks[0])==null?void 0:r.history.length)>1,s.boss.hp<s.boss.maxHp,s.director.lastOutcome!=="mixed",s.economy.crafted.length>=1,s.guild.operationsScore>0,s.cinematic.queue.length>=1,s.liveops.week>=2],t=a.filter(Boolean).length;return{done:t,total:a.length,pct:Math.round(t/a.length*100)}},[s]),m=s.safety??{mutedPlayerIds:[],blockedPlayerIds:[],reports:[]};return e.jsxs("section",{className:"gameplay-mode",children:[e.jsxs("header",{className:"gameplay-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Gameplay Command Center"}),e.jsx("p",{children:"World-class mechanics stack: raids, campaign, narrative, PvP, time control, boss runs, and liveops."}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:q,onChange:a=>G(a.target.value),placeholder:"Session name","aria-label":"Session name"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>y==null?void 0:y(q),children:"Create multiplayer session"}),e.jsx("input",{className:"search-input",value:T,onChange:a=>K(a.target.value),placeholder:"Session id","aria-label":"Join session id"}),e.jsxs("select",{value:B,onChange:a=>Q(a.target.value),children:[e.jsx("option",{value:"strategist",children:"Strategist"}),e.jsx("option",{value:"operator",children:"Operator"}),e.jsx("option",{value:"analyst",children:"Analyst"}),e.jsx("option",{value:"saboteur",children:"Saboteur"})]}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>d==null?void 0:d(T,o??"director",B),children:"Join session"}),i!=null&&i.id?e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>v==null?void 0:v(),children:"Leave session"}):null]}),e.jsxs("p",{children:["Session: ",(i==null?void 0:i.id)??"local-only"," ",o?`• Player ${o}`:""," ",i?`• Version ${i.version}`:""]}),O?e.jsx("p",{children:O}):null]}),e.jsxs("div",{className:"gameplay-completion","aria-label":"Gameplay completion",children:[e.jsxs("strong",{children:[P.done,"/",P.total]}),e.jsxs("span",{children:[P.pct,"% complete"]})]})]}),e.jsxs("div",{className:"gameplay-grid",children:[e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"1) Co-op Incident Raids"}),e.jsxs("p",{children:["Party: ",s.raid.party.length," members"]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:h,onChange:a=>A(a.target.value),placeholder:"Member name","aria-label":"Raid member name"}),e.jsxs("select",{value:_,onChange:a=>D(a.target.value),children:[e.jsx("option",{value:"strategist",children:"Strategist"}),e.jsx("option",{value:"operator",children:"Operator"}),e.jsx("option",{value:"analyst",children:"Analyst"}),e.jsx("option",{value:"saboteur",children:"Saboteur"})]}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>{h.trim()&&(L?d==null||d((i==null?void 0:i.id)??"",h.trim(),_):c(a=>le(a,h.trim(),_)),A(""))},children:"Add member"})]}),e.jsx("div",{className:"gameplay-objectives",children:s.raid.objectives.map(a=>e.jsxs("div",{className:"gameplay-objective",children:[e.jsx("span",{children:a.label}),e.jsxs("span",{children:[a.progress,"/",a.target]}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("raid.objective_progress",{objective_id:a.id,delta:25},t=>ce(t,a.id,25)),children:"+25"})]},a.id))})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"2) Roguelike Scenario Campaign"}),e.jsxs("p",{children:["Depth ",s.campaign.depth," • Lives ",s.campaign.lives]}),e.jsxs("p",{children:[s.campaign.currentMission.title," (difficulty ",s.campaign.currentMission.difficulty,")"]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"primary-button",type:"button",onClick:()=>l("campaign.resolve_mission",{success:!0},a=>H(a,!0)),children:"Mission success"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("campaign.resolve_mission",{success:!1},a=>H(a,!1)),children:"Mission fail"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"3) Branching Narrative Director"}),e.jsx("p",{children:u==null?void 0:u.title}),e.jsxs("p",{children:["Tension ",s.narrative.tension]}),e.jsx("div",{className:"gameplay-list",children:((u==null?void 0:u.choices)??[]).map(a=>e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("narrative.choose",{choice_id:a.id},t=>re(t,a.id)),children:a.label},a.id))})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"4) Skill Tree + Loadout"}),e.jsxs("p",{children:["Points ",s.skills.points," • Equipped ",s.skills.loadout.equipped.length,"/",s.skills.loadout.capacity]}),e.jsx("div",{className:"gameplay-list",children:s.skills.nodes.map(a=>e.jsxs("div",{className:"gameplay-node",children:[e.jsxs("span",{children:[a.label," (",a.cost,")"]}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("skills.unlock",{player_id:o??"director",skill_id:a.id},t=>oe(t,a.id)),children:a.unlocked?"Unlocked":"Unlock"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("skills.equip",{player_id:o??"director",skill_id:a.id},t=>de(t,a.id)),children:"Equip"})]},a.id))})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"5) Asymmetric PvP"}),e.jsxs("p",{children:["Round ",s.pvp.round," • Stability ",s.pvp.stability," • Sabotage ",s.pvp.sabotage]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("pvp.act",{action:"sabotage"},a=>M(a,"sabotage")),children:"Sabotage"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("pvp.act",{action:"stabilize"},a=>M(a,"stabilize")),children:"Stabilize"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("pvp.act",{action:"scan"},a=>M(a,"scan")),children:"Scan"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"6) Time Manipulation"}),e.jsxs("p",{children:["Active fork: ",s.time.activeForkId]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:S,onChange:a=>V(a.target.value),"aria-label":"Fork label"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("time.create_fork",{label:S,playhead_ms:g},a=>pe(a,S,g)),children:"Create fork"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("time.rewind",{amount_ms:1e3},a=>ue(a,1e3)),children:"Rewind 1s"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("time.merge",{fork_id:s.time.activeForkId},a=>he(a,a.time.activeForkId)),children:"Merge"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"7) Boss Encounter Runs"}),e.jsxs("p",{children:[s.boss.name," • Phase ",s.boss.phase," • HP ",s.boss.hp,"/",s.boss.maxHp]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("boss.act",{action:"strike"},a=>R(a,"strike")),children:"Strike"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("boss.act",{action:"shield"},a=>R(a,"shield")),children:"Shield"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("boss.act",{action:"exploit"},a=>R(a,"exploit")),children:"Exploit"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"8) Adaptive AI Dungeon Master"}),e.jsxs("p",{children:["Risk ",s.director.risk," • Outcome ",s.director.lastOutcome]}),e.jsx("p",{children:s.director.hint}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>{var W;const a=s.pvp.sabotage>s.pvp.stability?2:0,t=Math.floor((((W=s.raid.objectives[0])==null?void 0:W.progress)??0)/40),r=900+s.pvp.fog*10;l("director.evaluate",{failures:a,retries:t,latency_ms:r},se=>me(se,{failures:a,retries:t,latencyMs:r}))},children:"Recompute guidance"})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"9) Mission Economy + Crafting"}),e.jsxs("p",{children:["Credits ",s.economy.credits," • Materials ",s.economy.materials]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("economy.craft",{recipe_id:"stability_patch"},a=>I(a,"stability_patch")),children:"Craft stability patch"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("economy.craft",{recipe_id:"precision_lens"},a=>I(a,"precision_lens")),children:"Craft precision lens"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("economy.craft",{recipe_id:"overclock_core"},a=>I(a,"overclock_core")),children:"Craft overclock core"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"10) Guild Operations"}),e.jsxs("p",{children:[s.guild.name," • Ops score ",s.guild.operationsScore," • Events ",s.guild.eventsCompleted]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:x,onChange:a=>U(a.target.value),placeholder:"Guild id","aria-label":"Guild id"}),e.jsx("input",{className:"search-input",value:E,onChange:a=>X(a.target.value),placeholder:"Guild name","aria-label":"Guild name"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>N==null?void 0:N(x,E),children:"Create guild"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>k==null?void 0:k(x,h.trim()||o||"director"),children:"Join guild"})]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:F,onChange:a=>Y(a.target.value),placeholder:"Event title","aria-label":"Guild event title"}),e.jsx("input",{className:"search-input",value:w,onChange:a=>J(a.target.value),placeholder:"2026-02-16T20:00:00Z","aria-label":"Guild event schedule"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>C==null?void 0:C(x,F,w),children:"Schedule event"})]}),p?e.jsxs("div",{className:"gameplay-list",children:[e.jsxs("p",{children:[p.member_count," members • Score ",p.operations_score]}),p.scoreboard.slice(0,4).map(a=>e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:a.player_id}),e.jsx("span",{children:a.score})]},a.player_id)),p.events.slice(-3).map(a=>e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:a.title}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>f==null?void 0:f(p.id,a.id,10),children:"Complete"})]},a.id))]}):null,e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("guild.op",{impact:6},a=>Z(a,6)),children:"Positive op"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("guild.op",{impact:-3},a=>Z(a,-3)),children:"Risky op"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"11) Cinematic Event Engine"}),e.jsxs("p",{children:[s.cinematic.queue.length," queued events"]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("cinematic.emit",{event_type:"critical",message:"Critical cascade detected",intensity:3},a=>$(a,"critical","Critical cascade detected",3)),children:"Critical beat"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("cinematic.emit",{event_type:"success",message:"System stabilizing",intensity:2},a=>$(a,"success","System stabilizing",2)),children:"Success beat"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"12) Seasonal LiveOps"}),e.jsxs("p",{children:[s.liveops.season," • Week ",s.liveops.week]}),e.jsx("p",{children:s.liveops.challenge.title}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("liveops.advance_week",{},a=>ge(a)),children:"Next week"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>l("liveops.progress",{delta:1},a=>({...a,liveops:{...a.liveops,challenge:{...a.liveops.challenge,progress:be(a.liveops.challenge.progress+1,0,a.liveops.challenge.goal),completed:a.liveops.challenge.progress+1>=a.liveops.challenge.goal}}})),children:"Progress challenge"})]})]}),e.jsxs("article",{className:"gameplay-card",children:[e.jsx("h3",{children:"13) Safety and Moderation"}),e.jsxs("p",{children:["Muted ",m.mutedPlayerIds.length," • Blocked ",m.blockedPlayerIds.length," • Reports"," ",m.reports.length]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("input",{className:"search-input",value:j,onChange:a=>ee(a.target.value),placeholder:"Player id","aria-label":"Safety player id"}),e.jsx("input",{className:"search-input",value:z,onChange:a=>ae(a.target.value),placeholder:"Reason","aria-label":"Safety reason"})]}),e.jsxs("div",{className:"gameplay-inline",children:[e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>c(a=>te(a,j)),children:"Mute player"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>c(a=>ie(a,j)),children:"Block player"}),e.jsx("button",{className:"ghost-button",type:"button",onClick:()=>c(a=>ne(a,j,z)),children:"Report player"})]}),m.reports.length>0?e.jsx("div",{className:"gameplay-list",children:m.reports.slice(0,3).map(a=>e.jsxs("div",{className:"gameplay-node",children:[e.jsx("span",{children:a.targetPlayerId}),e.jsx("span",{children:a.reason})]},a.id))}):null]})]})]})}export{je as default};
